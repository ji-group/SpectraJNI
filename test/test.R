rm(list = ls())
library(Matrix)
mat1 <- matrix(c(-1.033,0,0,0.402468,0.281728,0.348806,0,0,0,0,0,0,0,-1.05983,0,0,0,0,0.402468,0.308559,0.348806,0,0,0,0,0,-0.992756,0,0,0,0,0,0,0.402468,0.308559,0.281728,0.308559,0.281728,0.348806,-0.939093,0,0,0,0,0,0,0,0,0,0,0,0,-1.05983,0,0.402468,0.308559,0.348806,0,0,0,0,0,0,0,0,-0.992756,0,0,0,0.402468,0.308559,0.281728,0.308559,0.281728,0.348806,0,0,0,-0.939093,0,0,0,0,0,0,0,0,0.402468,0.281728,0.348806,0,-1.033,0,0,0,0,0,0,0,0,0,0,0,0,-0.992756,0.402468,0.308559,0.281728,0.308559,0.281728,0.348806,0,0,0,0,0,0,-0.939093,0,0,0,0,0,0.402468,0.281728,0.348806,0,0,0,0,-1.033,0,0,0,0,0,0,0,0.402468,0.308559,0.348806,0,0,-1.05983),
               nrow = 12, ncol = 12, byrow = TRUE)
eigen(t(mat1))

freq <- c(0.3, 0.23, 0.21, 0.26)

hky <- matrix(c(-0.9390931043734907, 0.30855916286557555, 0.2817279313120472, 0.34880601019586804, 0.4024684733029246, -1.0330024148108399, 0.2817279313120472, 0.34880601019586804, 0.4024684733029246, 0.30855916286557555, -1.0598336463643683, 0.34880601019586804, 0.4024684733029246, 0.30855916286557555, 0.2817279313120472, -0.9927555674805474),
              4, 4, TRUE)

normal.factor <- 0
for (i in 1:4) {
  for (j in 1:4) {
    if (i != j) {
      normal.factor <- normal.factor + freq[i] * freq[j]
    }
  }
}

joint.freq <- c()
k <- 1
for (i in 1:4) {
  for (j in 1:4) {
    if (i != j) {
      joint.freq[k] <- freq[i] * freq[j] / normal.factor
      k <- k + 1
    }
  }
}

joint.freq.2 <- c()
k <- 1
for (i in 1:4) {
  for (j in 1:4) {
    if (i != j) {
      joint.freq.2[k] <- freq[j] * hky[i, j] / -hky[i, i]
      k <- k + 1
    }
  }
}

joint.freq.2 <- joint.freq.2/sum(joint.freq.2)

